let systems = await game.db.filter({}, "systems");
systems = systems.filter(sys=>!game.jobs[sys.id]&&sys.software.find(sw=>sw.malware&&sw.installed));

for (const sys of systems) {
	const mw = sys.software.filter(sw=>sw.malware&&sw.installed);
	for (const m of mw) {
		switch (m.type) {
			case "scrambler":
				game.malware.scrambler(sys);
				break;
			case "bitminer":
				game.malware.miner(sys);
				break;
		}
	}
	await game.db.set("systems", sys.id, sys);
}